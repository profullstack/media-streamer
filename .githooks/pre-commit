#!/bin/sh
# BitTorrented.com Pre-commit Hook
# Enforces TDD by running build and tests before every commit

echo "ğŸ”¨ Running pre-commit checks..."
echo ""

# Run build
echo "ğŸ“¦ Building application..."
pnpm build
BUILD_EXIT_CODE=$?

if [ $BUILD_EXIT_CODE -ne 0 ]; then
    echo ""
    echo "âŒ Build failed! Please fix build errors before committing."
    exit 1
fi

echo ""
echo "âœ… Build successful!"
echo ""

# Run tests
echo "ğŸ§ª Running tests..."
pnpm test
TEST_EXIT_CODE=$?

if [ $TEST_EXIT_CODE -ne 0 ]; then
    echo ""
    echo "âŒ Tests failed! Please fix failing tests before committing."
    exit 1
fi

echo ""
echo "âœ… All tests passed!"
echo ""
echo "ğŸš€ Pre-commit checks complete. Proceeding with commit..."
