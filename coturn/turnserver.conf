# Coturn TURN/STUN Server Configuration
# For WebTorrent P2P streaming NAT traversal

# Network settings
listening-port=3478
tls-listening-port=5349
listening-ip=0.0.0.0

# External IP - MUST be set to your server's public IP
# This is auto-detected if not set, but explicit is better
# Set via TURN_EXTERNAL_IP environment variable
# external-ip=YOUR_PUBLIC_IP

# Realm and server name
# Set via TURN_REALM environment variable (default: bittorrented.com)
realm=bittorrented.com
server-name=turn.bittorrented.com

# Authentication using shared secret (time-limited credentials)
# This is more secure than static username/password
# The app generates time-limited credentials using HMAC-SHA1
use-auth-secret
# Set via TURN_SECRET environment variable
static-auth-secret=change-this-secret-in-production

# Disable static user accounts (use only time-limited credentials)
no-cli

# Performance and limits
# Total bandwidth quota in KB/s (0 = unlimited)
# 6TB/month = ~2.3 GB/day = ~27 MB/s average
# Set to 50000 KB/s (50 MB/s) to allow bursts while staying under limit
total-quota=50000
# Per-session bandwidth limit in bytes/sec (0 = unlimited)
# Limit each session to 5 MB/s to prevent single users from hogging bandwidth
bps-capacity=5000000
max-bps=5000000
# Maximum allocations per user
user-quota=100
# Stale nonce lifetime in seconds
stale-nonce=600
# Maximum number of simultaneous TURN allocations
# Helps prevent resource exhaustion
max-allocate-lifetime=3600

# Relay settings
# Min/max ports for media relay (UDP)
min-port=49152
max-port=65535

# Enable fingerprinting for better NAT traversal
fingerprint

# Enable long-term credential mechanism
lt-cred-mech

# Logging
# Log to stdout for Docker
log-file=stdout
# Verbose logging (disable in production for performance)
# verbose

# Security settings
# Disable multicast peers
no-multicast-peers
# Disable TCP relay (WebRTC uses UDP)
no-tcp-relay
# Deny peers on loopback
denied-peer-ip=127.0.0.0-127.255.255.255
denied-peer-ip=::1

# Allow only UDP and TCP for client connections
# WebRTC primarily uses UDP
# no-tlsv1 and no-tlsv1_1 removed â€” unsupported in coturn 4.7+

# Mobility (for mobile clients that change networks)
mobility

# Process settings
proc-user=nobody
proc-group=nogroup
